             select distinct DocumentTable.DocumentId, DocumentTable.DocumentDate, DocumentTable.EntityName, DocumentTable.EntityKey,
					DocumentTable.DocumentType, /*ActTable.*/DocumentNumber, ActTable.DocumentName, ActTable.DocumentKind, ActTable.InsruanceCompany, 
					ActTable.DocumentExpirationDate 
                    from ( select (LEFT(aDoc.Name, CASE WHEN CHARINDEX(' ', aDoc.Name) = 0 then  LEN(aDoc.Name) else charindex(' ', aDoc.Name) -1 END)) as DocumentNumber, DocumentId as DocumentId, DocumentDate as DocumentDate, EntityName as EntityName, EntityKey as EntityKey, aDocType.Name as DocumentType, CompanyId from [Module].[Document] as aDoc left join [Module].[DocumentType] as aDocType on aDoc.DocumentTypeId = aDocType.DocumentTypeId ) as DocumentTable 
                    left join ( SELECT /*ActProtocolNumber as DocumentNumber,*/ ActName as DocumentName, aActType.Name as DocumentKind, aPartner.Name as InsruanceCompany , DocumentExpirationDate as DocumentExpirationDate , 'Case' AS EntityName, CAST(aAct.CompanyId AS VARCHAR(10))+'|'+CAST(aAct.OrganizationUnitId AS Varchar(10))+'|'+CAST(aAct.BusinessYearId AS VARCHAR(4))+'|'+CAST(CaseId AS VARCHAR(250)) AS EntityKey , aAct.CompanyId as CompanyId FROM [RecivedPost].[Act] as aAct 
                    inner join [RecivedPost].[ActType] as aActType ON aAct.ActTypeId = aActType.ActTypeId 
                    inner join [Catalog].[Partner] as aPartner ON aAct.PartnerId = aPartner.PartnerId AND aPartner.CompanyId = aAct.CompanyId ) as ActTable on ActTable.EntityName = DocumentTable.EntityName AND ActTable.EntityKey = DocumentTable.EntityKey AND DocumentTable.CompanyId = ActTable.CompanyId
